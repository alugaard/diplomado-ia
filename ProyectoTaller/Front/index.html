<!DOCTYPE html>
<html lang="es">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Cargas</title>
    <link rel="stylesheet" href="style.css?v=18">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600&display=swap" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>

<body>

    <div class="app-container">
        <!-- Sidebar -->
        <aside class="sidebar">


            <div class="sidebar-section">
                <h3>Modelos predictivos</h3>
                <label class="checkbox-wrapper">
                    <input type="checkbox" name="tf-idf" class="cb-tfidf" checked>
                    <span class="custom-checkbox"></span>
                    TF-IDF
                    <span class="color-indicator bg-tfidf"></span>
                </label>
                <label class="checkbox-wrapper">
                    <input type="checkbox" name="beto" class="cb-beto">
                    <span class="custom-checkbox"></span>
                    BETO
                    <span class="color-indicator bg-beto"></span>
                </label>
                <label class="checkbox-wrapper">
                    <input type="checkbox" name="gemini" class="cb-gemini">
                    <span class="custom-checkbox"></span>
                    GEMINI
                    <span class="color-indicator bg-gemini"></span>
                </label>
            </div>

            <!-- Removed sidebar-actions buttons -->
        </aside>

        <!-- Main Content -->
        <main class="main-content">
            <header class="top-nav">
                <nav
                    style="display: flex; background: var(--border-subtle); padding: 4px; border-radius: var(--radius-md);">
                    <button id="navCargas" class="nav-tab active">
                        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                            stroke-width="2">
                            <path
                                d="M21 16V8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16z">
                            </path>
                            <polyline points="3.27 6.96 12 12.01 20.73 6.96"></polyline>
                            <line x1="12" y1="22.08" x2="12" y2="12"></line>
                        </svg>
                        Cargas
                    </button>
                    <button id="navDashboards" class="nav-tab">
                        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                            stroke-width="2">
                            <rect x="3" y="3" width="7" height="9"></rect>
                            <rect x="14" y="3" width="7" height="5"></rect>
                            <rect x="14" y="12" width="7" height="9"></rect>
                            <rect x="3" y="16" width="7" height="5"></rect>
                        </svg>
                        Dashboards
                    </button>
                    <button id="navHistorial" class="nav-tab">
                        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                            stroke-width="2">
                            <circle cx="12" cy="12" r="10"></circle>
                            <polyline points="12 6 12 12 16 14"></polyline>
                        </svg>
                        Historial
                    </button>
                </nav>
            </header>
            <div class="content-header">
                <div class="mode-toggle">
                    <button id="archiveRefreshBtn" class="refresh-context-btn" title="Reiniciar Carga Archivo">
                        <svg width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                            stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                            <path d="M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8"></path>
                            <path d="M21 3v5h-5"></path>
                            <path d="M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16"></path>
                            <path d="M3 21v-5h5"></path>
                        </svg>
                    </button>
                    <button id="archivoModeBtn" class="mode-btn active">Archivo</button>
                    <button id="manualModeBtn" class="mode-btn">Manual</button>
                    <button id="manualRefreshBtn" class="refresh-context-btn" title="Limpiar Filas Manuales"
                        style="display: none;">
                        <svg width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                            stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                            <path d="M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8"></path>
                            <path d="M21 3v5h-5"></path>
                            <path d="M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16"></path>
                            <path d="M3 21v-5h5"></path>
                        </svg>
                    </button>
                </div>
            </div>

            <div class="work-area">
                <!-- Drop Zone State (Mockup 1) -->
                <div class="drop-zone" id="dropZone">
                    <div class="drop-zone-content">
                        <div class="plus-icon" id="uploadTrigger">+</div>
                        <p>Arrastrar o cargar archivo</p>
                        <input type="file" id="fileInput" accept=".csv" hidden>
                    </div>
                </div>

                <!-- Table Result State (Mockup 2) - Initially Hidden -->
                <!-- Use 'display: none' in CSS or toggle class to show -->
                <div class="results-table-container hidden" id="resultsTable">
                    <div style="display: flex; flex-direction: column; gap: 10px;">
                        <table class="data-table" style="width: 100%;">
                            <thead>
                                <tr>
                                    <th style="width: 60%;">Comentario</th>
                                    <th style="width: 25%;">Clasificación</th>
                                    <th style="width: 15%; text-align: center;">
                                        <button id="predictAllBtn" class="btn btn-primary"
                                            style="padding: 4px 8px; font-size: 0.8rem;">Predecir Todo</button>
                                    </th>
                                    <th style="width: 50px;"><button id="addManualRowBtn"
                                            class="header-add-btn">+</button></th>
                                </tr>
                            </thead>
                            <tbody id="manualTableBody">
                                <!-- Rows will be added here dynamically -->
                            </tbody>
                        </table>

                        <!-- Predict All Button moved to header -->
                    </div>
                </div>

                <!-- CSV Preview Table Container -->
                <div class="results-table-container hidden" id="csvPreviewTable">
                    <div style="display: flex; flex-direction: column; gap: 10px;">
                        <table class="data-table" id="csvTableContent" style="width: 100%;">
                            <!-- CSV Data will be injected here -->
                        </table>

                        <div style="align-self: flex-end; padding: 10px 0;">
                            <!-- CSV Predict Button managed in script.js now -->
                        </div>
                    </div>
                    <div class="pagination-controls" id="paginationControls">
                        <button id="prevPage" class="pagination-btn" disabled>&lt; Anterior</button>
                        <span id="pageIndicator">Página 1</span>
                        <button id="nextPage" class="pagination-btn">Siguiente &gt;</button>
                    </div>
                </div>
                <!-- Historial View -->
                <div class="results-table-container hidden" id="historialView">
                    <table class="data-table" id="historialTable">
                        <thead>
                            <tr>
                                <th>Archivo</th>
                                <th>Fecha de Carga</th>
                                <th>Usuario</th>
                                <th>Acciones</th>
                            </tr>
                        </thead>
                        <tbody id="historialTableBody">
                            <!-- History entries will be added here dynamically -->
                        </tbody>
                    </table>
                    <div id="emptyHistorialMessage" class="empty-state hidden">
                        <p>No hay archivos en el historial.</p>
                    </div>
                </div>

                <!-- Dashboards View -->
                <div class="dashboard-container hidden" id="dashboardView">
                    <!-- Global History Chart -->
                    <div class="chart-section">
                        <h3>Distribución de Clasificaciones (Histórico Global)</h3>
                        <div class="chart-wrapper">
                            <canvas id="classificationChart"></canvas>
                        </div>
                    </div>

                    <hr class="dashboard-divider">

                    <!-- File Specific Chart -->
                    <div class="chart-section">
                        <h3>Distribución por Archivo</h3>
                        <div class="selector-container">
                            <label for="historyFileSelector">Seleccionar Archivo:</label>
                            <select id="historyFileSelector" class="form-select">
                                <option value="">-- Seleccionar --</option>
                            </select>
                        </div>
                        <div class="chart-wrapper">
                            <canvas id="fileChart"></canvas>
                        </div>
                    </div>

                    <hr class="dashboard-divider">

                    <!-- Country Chart -->
                    <div class="chart-section">
                        <h3>Distribución por País</h3>
                        <div class="chart-wrapper">
                            <canvas id="countryChart"></canvas>
                        </div>
                    </div>
                </div>

            </div>
        </main>
    </div>

    <!-- Modal for CSV Preview -->
    <div id="csvModal" class="modal-overlay hidden">
        <div class="modal-content">
            <div class="modal-header">
                <h3 id="modalTitle">Vista Previa</h3>
                <button id="modalCloseBtn" class="modal-close-btn">&times;</button>
            </div>
            <div class="modal-body">
                <table class="data-table" id="modalTable">
                    <thead id="modalTableHead"></thead>
                    <tbody id="modalTableBody"></tbody>
                </table>
            </div>
        </div>
    </div>

    <script src="config.js?v=18"></script>
    <script src="script.js?v=18"></script>
</body>

</html>